
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>完美匹配</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
        
        <link rel="stylesheet" href="../gitbook/ebook.css">
        
    

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-ace/pdf.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/ebook.css">
                
            
        

    

    
        
    

        
    </head>
    <body>
        
<div class="page">
    
        <h1 class="book-chapter book-chapter-3">完美匹配</h1>
        <div class="section">
            <h2 id="&#x6700;&#x4F73;&#x5B8C;&#x7F8E;&#x5339;&#x914D;">&#x6700;&#x4F73;&#x5B8C;&#x7F8E;&#x5339;&#x914D;</h2>
<pre><code class="lang-C++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">match</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    S[u] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> v = <span class="hljs-number">1</span>; v &lt;= n; v++) <span class="hljs-keyword">if</span>(!T[v]) {
        <span class="hljs-keyword">int</span> gap = lx[u]+ly[v]-w[u][v];
        <span class="hljs-keyword">if</span>(gap == <span class="hljs-number">0</span>) {
            T[v] = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span>(!ylink[v] || match(ylink[v])) {
                xlink[u] = v, ylink[v] = u;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        } <span class="hljs-keyword">else</span> {
            slack[v] = min(slack[v], gap);
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> a = inf;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) <span class="hljs-keyword">if</span>(!T[i]) a = min(a, slack[i]);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">if</span>(S[i]) lx[i] -= a;
        <span class="hljs-keyword">if</span>(T[i]) ly[i] += a;
        <span class="hljs-keyword">else</span> slack[i] -= a;
    }
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">KM</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        xlink[i] = ylink[i] = lx[i] = ly[i] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) lx[i] = max(lx[i], w[i][j]);
    }
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) slack[j] = inf;
        <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j++) S[j] = T[j] = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">if</span>(match(i)) <span class="hljs-keyword">break</span>; <span class="hljs-keyword">else</span> update();
        }
    }
}
</code></pre>

        </div>
    
</div>

        
    </body>
</html>

