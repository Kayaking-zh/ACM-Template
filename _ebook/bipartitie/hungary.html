
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>最大匹配</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
        
        <link rel="stylesheet" href="../gitbook/ebook.css">
        
    

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-ace/pdf.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/ebook.css">
                
            
        

    

    
        
    

        
    </head>
    <body>
        
<div class="page">
    
        <h1 class="book-chapter book-chapter-3">最大匹配</h1>
        <div class="section">
            <h2 id="&#x5308;&#x7259;&#x5229;&#x7B97;&#x6CD5;">&#x5308;&#x7259;&#x5229;&#x7B97;&#x6CD5;</h2>
<pre><code class="lang-C++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">hungary</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    vis[u] = clk;
    <span class="hljs-keyword">int</span> v;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = head[u]; i; i = nxt[i]) <span class="hljs-keyword">if</span>(vis[v = to[i]] != clk) {
        vis[v] = clk;
        <span class="hljs-keyword">if</span>(!xlink[v] || hungary(ylink[v])) {
            xlink[u] = v, ylink[v] = u;
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h2 id="hopcroft-karp">Hopcroft-Karp</h2>
<pre><code class="lang-c++"><span class="hljs-keyword">int</span> n, m, w;
<span class="hljs-keyword">int</span> vis[N], xlink[N], ylink[N], dis[N];
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;G[N];

<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">BFS</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">queue</span>&lt;<span class="hljs-keyword">int</span>&gt;q;
    <span class="hljs-built_in">memset</span>(dis, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(dis));
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)
        <span class="hljs-keyword">if</span>(xlink[i] == <span class="hljs-number">-1</span>) {
            q.push(i); dis[i] = <span class="hljs-number">0</span>;
        }
    w = INT_INF;
    <span class="hljs-keyword">while</span>(!q.empty()) {
        <span class="hljs-keyword">int</span> p = q.front(); q.pop();
        <span class="hljs-keyword">if</span>(dis[p] &gt; w) <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; G[p].size(); i++) {
            <span class="hljs-keyword">int</span> l = G[p][i];
            <span class="hljs-keyword">if</span>(dis[l] == <span class="hljs-number">-1</span>) {
                dis[l] = dis[p] + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span>(ylink[l] == <span class="hljs-number">-1</span>) w = dis[l];
                <span class="hljs-keyword">else</span> {
                    dis[ylink[l]] = dis[l] + <span class="hljs-number">1</span>;
                    q.push(ylink[l]);
                }
            }
        }
    }
    <span class="hljs-keyword">return</span> w != INT_INF;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; G[u].size(); i++) {
        <span class="hljs-keyword">int</span> l = G[u][i];
        <span class="hljs-keyword">if</span>(!vis[l] &amp;&amp; dis[l] == dis[u] + <span class="hljs-number">1</span>) {
            vis[l] = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span>(ylink[l] != <span class="hljs-number">-1</span> &amp;&amp; dis[l] == w) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span>(ylink[l] == <span class="hljs-number">-1</span> || Find(ylink[l])) {
                xlink[u] = l, ylink[l] = u;
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);
    <span class="hljs-keyword">int</span> u, v;
    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;u, &amp;v) != EOF) G[u].push_back(v);
    <span class="hljs-built_in">memset</span>(xlink, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(xlink));
    <span class="hljs-built_in">memset</span>(ylink, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(ylink));
    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span>(BFS()) {
        <span class="hljs-built_in">memset</span>(vis, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(vis));
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)
            <span class="hljs-keyword">if</span>(xlink[i] == <span class="hljs-number">-1</span>) ans += Find(i);
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ans);
}
</code></pre>

        </div>
    
</div>

        
    </body>
</html>

